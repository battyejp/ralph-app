# Ralph Progress Log
Started: 01/15/2026 16:03:23
---

## 2026-01-15 16:10 - US-001
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented Next.js frontend project initialization
- Created complete Next.js 14 project structure with TypeScript and App Router
- Configured Tailwind CSS with shadcn/ui design system
- Set up project directories: src/app, src/components, src/lib
- Added environment configuration for API URL
- Created comprehensive .gitignore for frontend
- Added README with setup instructions

**Files Created:**
- package.json (Next.js dependencies and scripts)
- tsconfig.json (TypeScript configuration)
- next.config.ts (Next.js configuration)
- tailwind.config.ts (Tailwind CSS with shadcn/ui theme)
- postcss.config.mjs (PostCSS configuration)
- .eslintrc.json (ESLint configuration)
- components.json (shadcn/ui configuration)
- src/app/layout.tsx (Root layout)
- src/app/page.tsx (Home page)
- src/app/globals.css (Global styles with theme variables)
- src/lib/utils.ts (Utility functions for className merging)
- .env.local and .env.example (Environment configuration)
- .gitignore (Frontend-specific gitignore)
- README.md (Setup instructions)

**Learnings for future iterations:**
- Node.js is not installed on the host system, so manual scaffolding was required
- The project will need to be run via Docker (see US-002, US-004)
- shadcn/ui dependencies include: @radix-ui components, class-variance-authority, clsx, tailwind-merge, lucide-react
- Environment variables use NEXT_PUBLIC_ prefix for client-side access
- Next.js 14 uses App Router (app directory) not Pages Router
---

## 2026-01-15 16:35 - US-002
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created multi-stage Dockerfile for Next.js frontend
- Configured development stage with hot reload support
- Added build and production stages for optimized deployment
- Created .dockerignore to optimize build context
- Successfully built Docker image for dev stage

**Files Created:**
- src/frontend/Dockerfile (Multi-stage Docker build)
- src/frontend/.dockerignore (Optimize build context)

**Learnings for future iterations:**
- Docker builds successfully using Node.js 20 Alpine
- Multi-stage build includes: base, deps, dev, builder, production stages
- Development stage uses `npm run dev` with hot reload support
- Port 3000 exposed for Next.js development server
- .dockerignore should exclude node_modules, .next, out, .git to reduce build context size
- Without .dockerignore, build context was over 360MB; with it, much smaller and faster
- Production stage requires standalone output configuration in next.config.ts (for future)
---

## 2026-01-15 16:40 - US-003
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Created multi-stage Dockerfile for .NET backend API
- Configured build, publish, and runtime stages
- Added .dockerignore to optimize build context
- Successfully built and verified Docker image

**Files Created:**
- src/backend/CustomerApi/Dockerfile (Multi-stage Docker build)
- src/backend/CustomerApi/.dockerignore (Optimize build context)

**Learnings for future iterations:**
- Backend uses .NET 10.0 (net10.0), not .NET 8 as originally specified
- Used mcr.microsoft.com/dotnet/sdk:10.0 for build stage
- Used mcr.microsoft.com/dotnet/aspnet:10.0 for runtime stage
- Multi-stage build includes: build, publish, and runtime stages
- API exposed on port 5000 via ASPNETCORE_URLS environment variable
- .dockerignore should exclude bin/, obj/, .vs/, .vscode/ to reduce build context
- Dockerfile uses dotnet restore, build, and publish commands in sequence
- Build completed successfully with 0 warnings and 0 errors
---
## 2026-01-15 19:13 - US-004
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Configured Docker Compose for all services (MySQL, Backend API, Frontend)
- Added backend service with proper dependencies and health checks
- Added frontend service with volume mounts for hot reload support
- Verified all services start successfully and are accessible
- Frontend accessible at http://localhost:3000
- Backend accessible at http://localhost:5000 (healthy)
- MySQL accessible at localhost:3306

**Files Modified:**
- docker-compose.yml (Added backend and frontend services)

**Learnings for future iterations:**
- Backend service depends on MySQL with health check condition
- Frontend service depends on backend (basic dependency, no health check needed)
- Backend uses ASPNETCORE_URLS environment variable to bind to port 5000
- Backend connection string uses "Server=mysql" (service name) instead of localhost
- Frontend uses volume mounts for hot reload: ./src/frontend:/app with exclusions for node_modules and .next
- Frontend target is "dev" stage from multi-stage Dockerfile for development mode
- All services use restart: always for automatic recovery
- Backend health check uses curl to /health endpoint with 30s start_period
- NEXT_PUBLIC_API_URL should point to http://localhost:5000 for client-side API calls
---

## 2026-01-15 19:28 - US-005
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented API Client Service Layer for frontend
- Created TypeScript interfaces matching backend DTOs (Customer, PaginatedResponse, CustomerSearchParams, ApiErrorResponse)
- Implemented customerApi service with searchCustomers() and getCustomerById() methods
- Added comprehensive error handling with custom ApiError class
- Configured Jest testing framework for frontend
- Created comprehensive test suite with 15 tests, 97.82% coverage
- Build verified successfully via Docker
- API connectivity verified

**Files Created:**
- src/frontend/src/lib/api/types.ts (TypeScript interfaces)
- src/frontend/src/lib/api/customerApi.ts (API client service with error handling)
- src/frontend/src/lib/api/customerApi.test.ts (Comprehensive test suite)
- src/frontend/jest.config.js (Jest configuration with 80% coverage threshold)
- src/frontend/jest.setup.js (Jest setup file)

**Files Modified:**
- src/frontend/package.json (Added Jest, testing-library, test scripts)
- src/frontend/package-lock.json (Dependency updates)

**Learnings for future iterations:**
- API client uses singleton pattern exported as `customerApi`
- ApiError class extends Error with status and errors properties for structured error handling
- Network errors (TypeError) are caught and wrapped in ApiError with user-friendly messages
- Base URL is configured from NEXT_PUBLIC_API_URL environment variable (defaults to http://localhost:5000)
- Query parameters are built using URLSearchParams for proper encoding
- Jest tests use mocked global.fetch for isolated unit testing
- Coverage excludes src/app/** and src/lib/utils.ts to focus on API client code
- Tests must be run in Docker since Node.js is not installed on host
- Build command: `docker run --rm frontend-dev npm run build`
- Test command: `docker run --rm frontend-dev npm test -- --coverage`
- The backend requires database migrations to be applied before the Customers table exists (this will need to be addressed in future iterations)
---
## 2026-01-15 19:45 - US-006
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented Advanced Search Form with multiple filter fields
- Created shadcn/ui components: Button, Input, Label in src/components/ui/
- Built SearchForm component with three search fields:
  - General search (name/email)
  - Email exact match
  - Phone number search
- Implemented useDebounce custom hook with 500ms delay for better UX
- Added clear/reset filters functionality
- Integrated SearchForm into home page with loading state
- Created comprehensive test suite with 45 test cases
- Achieved 96.42% branch coverage (exceeds 80% requirement)
- Build verified successfully in Docker
- Browser verification completed using dev-browser skill
- All functionality working: form inputs, search button, clear button, responsive design

**Files Created:**
- src/frontend/src/components/ui/button.tsx (shadcn/ui Button component)
- src/frontend/src/components/ui/input.tsx (shadcn/ui Input component)
- src/frontend/src/components/ui/label.tsx (shadcn/ui Label component)
- src/frontend/src/components/SearchForm.tsx (Main search form component)
- src/frontend/src/components/SearchForm.test.tsx (Comprehensive test suite with 28 tests)
- src/frontend/src/hooks/useDebounce.ts (Custom debounce hook)
- src/frontend/src/hooks/useDebounce.test.ts (Hook tests with 17 test cases)

**Files Modified:**
- src/frontend/src/app/page.tsx (Integrated SearchForm with state management)

**Learnings for future iterations:**
- shadcn/ui components were created manually since npx is not available on host
- Components use Radix UI primitives (@radix-ui/react-slot, @radix-ui/react-label)
- Button component uses class-variance-authority for variant management
- useDebounce hook is critical for good UX - prevents excessive API calls
- SearchForm uses controlled inputs with React useState
- Phone search is combined with general search parameter in API call
- Form is responsive using Tailwind classes: grid-cols-1 md:grid-cols-3, flex-col sm:flex-row
- Loading state disables all inputs and buttons during search
- Tests mock useDebounce to make them synchronous for easier testing
- Browser verification using dev-browser skill confirmed all interactive functionality
- Next.js 14 'use client' directive required for components with useState
---

## 2026-01-15 20:00 - US-007
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented Display Search Results Table feature
- Created CustomerResultsTable component with all required states:
  - Loading state with animated spinner
  - Empty state with helpful user message
  - Error state with user-friendly error display
  - Success state with data table and mobile cards
- Built shadcn/ui Table component for desktop view
- Implemented responsive design with card view for mobile (md: breakpoint)
- Integrated results table into home page with API calls
- Connected to customerApi service with proper error handling
- All 72 tests passing with 97.05% statement coverage, 97.14% branch coverage
- Build verified successfully
- Browser verification completed - UI renders correctly

**Files Created:**
- src/frontend/src/components/ui/table.tsx (shadcn/ui Table component with all subcomponents)
- src/frontend/src/components/CustomerResultsTable.tsx (Main results table component)
- src/frontend/src/components/CustomerResultsTable.test.tsx (Comprehensive test suite with 72 tests)

**Files Modified:**
- src/frontend/src/app/page.tsx (Integrated CustomerResultsTable with API calls and state management)

**Learnings for future iterations:**
- CustomerResultsTable renders both desktop table and mobile cards simultaneously (both hidden/shown via Tailwind classes)
- When testing components with duplicate content for responsive views, use getAllByText() instead of getByText()
- Table component uses shadcn/ui styling with Tailwind classes: hidden md:block for desktop, md:hidden for mobile
- Mobile card view uses grid layout with border, rounded corners, and hover effects
- Date formatting uses toLocaleDateString() with en-US locale for consistency
- Customer rows are clickable and trigger onCustomerClick callback (prepared for US-010 details modal)
- Empty state includes search icon and helpful message about adjusting filters
- Error state includes warning icon and displays the error message from ApiError
- Loading state shows centered spinner with descriptive text
- Results only show after hasSearched is true (prevents showing empty state on page load)
- ESLint requires HTML entities for apostrophes in JSX (use &apos; instead of ')
- Component successfully handles all state precedence: loading > error > empty > success
---

## 2026-01-15 22:45 - US-008
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented Pagination Controls for customer search results
- Created shadcn/ui Select component with all required subcomponents
- Built PaginationControls component with:
  - Current page, total pages, and total count display
  - Previous/Next navigation buttons with proper disabled states
  - Page size selector dropdown (10, 25, 50, 100 options)
  - Responsive layout for mobile and desktop
- Integrated pagination into home page (page.tsx):
  - Added pagination state management (currentPage, pageSize, totalPages, totalCount)
  - Implemented URL parameter management with Next.js useSearchParams
  - Wrapped component in Suspense boundary for Next.js compliance
  - Preserve search filters when changing pages or page size
  - Reset to page 1 when new search or page size changes
- Created comprehensive test suite with 97 tests total across all components
- Achieved 94.94% statement coverage and 97.95% branch coverage
- Build verified successfully in Docker
- Frontend service running and accessible at http://localhost:3000

**Files Created:**
- src/frontend/src/components/ui/select.tsx (shadcn/ui Select component)
- src/frontend/src/components/PaginationControls.tsx (Pagination component)
- src/frontend/src/components/PaginationControls.test.tsx (Test suite with 30+ tests)

**Files Modified:**
- src/frontend/src/app/page.tsx (Integrated pagination, added Suspense boundary, URL management)

**Learnings for future iterations:**
- Next.js 14 requires useSearchParams() to be wrapped in a Suspense boundary to avoid prerendering errors
- Split the component into HomeContent (uses useSearchParams) and Home (wraps in Suspense)
- Suspense fallback provides loading state while params are being resolved
- URL parameters should only include non-default values (page > 1, pageSize != 25) to keep URLs clean
- router.push() updates URL without full page reload, perfect for client-side pagination
- PaginationControls only shows when totalCount > 0 and there's no error
- Page size changes should reset to page 1 to avoid showing empty results
- The Select component uses Radix UI primitives: Root, Trigger, Content, Item, Value, etc.
- Select dropdown requires proper z-index (z-50) and Portal to render above other content
- All pagination state must be synchronized: local state, URL params, and API calls
---

## 2026-01-15 23:45 - US-009
Thread: https://ampcode.com/threads/$AMP_CURRENT_THREAD_ID
- Implemented Column Sorting for customer search results
- Created SortableTableHeader component with visual sort indicators (up/down arrows)
- Added sortable columns: Name, Email, Created At (Phone is not sortable)
- Implemented sort state management in page.tsx:
  - Added sortBy and sortOrder state variables
  - Created handleSortChange function with toggle logic (asc <-> desc)
  - Integrated sort parameters into all API calls (search, pagination, page size change)
  - URL parameters updated with sortBy and sortOrder
- Sort indicators show active column with primary color, inactive columns muted
- Sort state preserved across pagination, page size changes, and new searches
- Comprehensive test suite added with 33+ new tests for sorting functionality
- All 118 tests passing with 95.05% statement coverage
- Build verified successfully in Docker
- Frontend service running and accessible

**Files Modified:**
- src/frontend/src/components/CustomerResultsTable.tsx (Added SortableTableHeader component, updated props)
- src/frontend/src/components/CustomerResultsTable.test.tsx (Added comprehensive sorting tests)
- src/frontend/src/app/page.tsx (Added sort state, handleSortChange, integrated sort into all API calls)

**Learnings for future iterations:**
- SortableTableHeader is a reusable component that renders clickable column headers with sort indicators
- Sort indicators use SVG arrows with conditional styling: text-primary when active, text-muted-foreground/30 when inactive
- handleSortChange toggles between asc/desc when clicking the same column, defaults to asc for new column
- Sort parameters must be included in all API calls: handleSearch, handlePageChange, handlePageSizeChange
- URL state management via updateURL ensures browser back/forward works with sorting
- Phone column is intentionally not sortable (backend doesn't support it)
- Table headers use cursor-pointer and select-none classes for better UX
- Hover effect on sortable headers: hover:bg-muted/50
- All sort state is synchronized between: local state, URL params, and API calls
- Tests verify: clickability, sort indicators, click handlers, state combinations, and interaction with loading/error/empty states
---

